panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Calibri", colour = "black", size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Calibri", colour = "black", size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "sans", colour = "black", size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "serif", colour = "black", size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Short", colour = "black", size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black", fontface= "bold",
size = 9))
fontface
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 9))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 12))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 12),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 12))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11))
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11)
legend.title.align	= 0.5)
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title.align	= 0.5)
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Comic sans", colour = "black",
size = 11),
legend.title.align	= 0.5)
#fla 0.1
maespa_n_others_fla_0.1 %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ tree-1 d-1)",
colour = "Canopy Approximation") +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "sans", colour = "black",
size = 11),
legend.title.align	= 0.5)
H <- c(15)
V <- c(0, 0.1, 0.25, 0.5)
L <- c(0.44, 1.521, 2.916, 4.556, 5.402)
F <- c(1.00)
fla <- c(0.1)
S <- c(1, 2, 3)
combinations_stand_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_stand_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path)) %>%
add_column(la_stand = c(rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57),
rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57),
rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57),
rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57)))
library(Maeswrap)
library(tidyverse)
library(ggplot2)
combinations_stand_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_stand_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path)) %>%
add_column(la_stand = c(rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57),
rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57),
rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57),
rep(1.6, 57), rep(3.6, 57), rep(6.4, 57), rep(10, 57), rep(12.1, 57)))
combinations_stand_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_stand_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path))
combinations_stand_fla_0.1
combinations_stand_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_stand_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path)) %>%
add_column(la_stand = c(rep(1.6, 3), rep(3.6, 3), rep(6.4, 3), rep(10, 3), rep(12.1, 3),
rep(1.6, 3), rep(3.6, 3), rep(6.4, 3), rep(10, 3), rep(12.1, 3),
rep(1.6, 3), rep(3.6, 3), rep(6.4, 3), rep(10, 3), rep(12.1, 3),
rep(1.6, 3), rep(3.6, 3), rep(6.4, 3), rep(10, 3), rep(12.1, 3)))
combinations_stand_fla_0.1
results_stand_fla_0.1 <- combinations_stand_fla_0.1$path[1:nrow(combinations_stand_fla_0.1)] %>%
purrr::map(load_trees_stand)
names(results_stand_fla_0.1) <- combinations_stand_fla_0.1$path[1:nrow(combinations_stand_fla_0.1)] %>%
basename()
model_conditions_stand_fla_0.1 <- results_stand_fla_0.1 %>%
purrr::map(model_simp)
results_PAR_ft_stand_fla_0.1 <- model_conditions_stand_fla_0.1 %>%
purrr::map(PAR_calculator_ft)
View(model_conditions_stand_fla_0.1)
View(model_conditions_stand_fla_0.1[["H15_V0_L0.44_F1_fla0.1_S1"]])
View(model_conditions_stand_fla_0.1[["H15_V0_L5.402_F1_fla0.1_S2"]])
View(model_conditions_stand_fla_0.1[["H15_V0.25_L4.556_F1_fla0.1_S2"]])
View(model_conditions_stand_fla_0.1[["H15_V0.5_L5.402_F1_fla0.1_S3"]])
results_PAR_ft_stand_fla_0.1 <- model_conditions_stand_fla_0.1 %>%
purrr::map(PAR_calculator_ft)
data  = model_conditions_stand_fla_0.1[[1]]
data
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
# load met and convert PAR to J/hr
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft),
PAR_two_s = 0.77*PAR*(exp(-0.77*L_ft) + (1- exp(-0.77*L_ft))*exp(-0.4*L_ft)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH  # MJ
)
# integrate over the day using trapezoidal integration
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * indi_la,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * indi_la)
indi_la = 1
# integrate over the day using trapezoidal integration
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * indi_la,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * indi_la)
View(model_conditions_stand_fla_0.1)
data  = model_conditions_stand_fla_0.1[[4]]
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
# load met and convert PAR to J/hr
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft),
PAR_two_s = 0.77*PAR*(exp(-0.77*L_ft) + (1- exp(-0.77*L_ft))*exp(-0.4*L_ft)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH  # MJ
)
# integrate over the day using trapezoidal integration
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * indi_la,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * indi_la)
data  = model_conditions_stand_fla_0.1[[7]]
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
# load met and convert PAR to J/hr
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft),
PAR_two_s = 0.77*PAR*(exp(-0.77*L_ft) + (1- exp(-0.77*L_ft))*exp(-0.4*L_ft)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH  # MJ
)
# integrate over the day using trapezoidal integration
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * indi_la,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * indi_la)
data  = model_conditions_stand_fla_0.1[[10]]
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
# load met and convert PAR to J/hr
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft),
PAR_two_s = 0.77*PAR*(exp(-0.77*L_ft) + (1- exp(-0.77*L_ft))*exp(-0.4*L_ft)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH  # MJ
)
# integrate over the day using trapezoidal integration
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * indi_la,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * indi_la)
data  = model_conditions_stand_fla_0.1[[13]]
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
# load met and convert PAR to J/hr
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft),
PAR_two_s = 0.77*PAR*(exp(-0.77*L_ft) + (1- exp(-0.77*L_ft))*exp(-0.4*L_ft)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH  # MJ
)
# integrate over the day using trapezoidal integration
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * indi_la,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * indi_la)
results_PAR_ft_stand_fla_0.1 <- model_conditions_stand_fla_0.1[[1:10]] %>%
purrr::map(PAR_calculator_ft)
data  = model_conditions_stand_fla_0.1[[13]]
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
L_ft
data
data  = model_conditions_stand_fla_0.1[[50]]
data
# constant to converts ymol/s to M J / h
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
L_ft <- data %>%
filter(focal == "TRUE") %>%
pull(lai)
L_ft
# load met and convert PAR to J/hr
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft),
PAR_two_s = 0.77*PAR*(exp(-0.77*L_ft) + (1- exp(-0.77*L_ft))*exp(-0.4*L_ft)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH  # MJ
)
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR)
met
met <-
readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*L_ft))
L_ft
