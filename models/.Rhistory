group_by(t_h
results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h)
results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h)
results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea), focal = focal) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
#need to add focal column here
model_simp <- function(data) {
df <- results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea), focal = focal) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data <- model_simp(results[["H15_V0.25_L2.916_F1.99_S1"]])
View(data)
#need to add focal column here
model_simp <- function(data) {
df <- results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
at <- model_simp(results[["H15_V0.25_L2.916_F1.99_S1"]])
View(at)
#need to add focal column here
model_simp <- function(data) {
df <- results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data <- model_simp(results[["H15_V0.25_L2.916_F1.99_S1"]])
View(data)
data <- model_simp(results[["H15_V0.5_L2.916_F1.99_S1"]])
View(data)
data <- model_simp(results[["H15_V0.75_L2.916_F1.99_S1"]])
View(data)
model_simp <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data <- model_simp(results[["H15_V0.75_L2.916_F1.99_S1"]])
results[["H15_V0_L2.916_F1.99_S1"]] %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
model_simp <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
View(combinations)
data <- model_simp(results[["H15_V0.1_L5.485_F1.35_S2"]])
View(data)
data <- model_simp(results[["H15_V0.1_L5.485_F1.99_S2"]])
View(data)
plotting <- function(d, foc) {
df <-
bind_rows(d, d %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
df_foc <- df %>%
filter(focal != "TRUE", new == "og")
ggplot(data = df, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_foc, aes(t_h, light_ft), colour='red') +
geom_point(data = df_foc, aes(t_h, light_ppa), colour='orange')
}
plotting(d = data, foc = 1.99)
df <-
bind_rows(data, data %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
df_foc <- df %>%
filter(focal == "TRUE", new == "og")
ggplot(data = df, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_foc, aes(t_h, light_ft), colour='red') +
geom_point(data = df_foc, aes(t_h, light_ppa), colour='orange')
plotting <- function(d) {
df <-
bind_rows(d, d %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og")) %>%
filter(focal == "FALSE")
df_foc <- df %>%
filter(focal == "TRUE", new == "og")
ggplot(data = df, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_foc, aes(t_h, light_ft), colour='red') +
geom_point(data = df_foc, aes(t_h, light_ppa), colour='orange')
}
plotting(d = data, foc = 1.99)
plotting(d = data)
df <-
bind_rows(data, data %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og")) %>%
filter(focal == "FALSE")
View(df)
df_foc <- df %>%
filter(focal == "TRUE", new == "og")
View(df_foc)
View(data)
plotting <- function(d) {
df <-
bind_rows(data, data %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
df_n_foc <- df %>%
filter(focal == "FALSE")
df_foc <- df %>%
filter(focal == "TRUE", new == "og")
ggplot(data = df, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_foc, aes(t_h, light_ft), colour='red') +
geom_point(data = df_foc, aes(t_h, light_ppa), colour='orange')
}
plotting <- function(d) {
df <-
bind_rows(d, d %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
df_n_foc <- df %>%
filter(focal == "FALSE")
df_foc <- df %>%
filter(focal == "TRUE", new == "og")
ggplot(data = df_n_foc, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_foc, aes(t_h, light_ft), colour='red') +
geom_point(data = df_foc, aes(t_h, light_ppa), colour='orange')
}
plotting(d = data)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
model_simp_nf <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa)) %>%
filter(focal == "FALSE")
}
library(Maeswrap)
library(tidyverse)
data_f <- model_simp_f(results[["H15_V0.1_L5.485_F1.99_S2"]])
View(data_f)
data_nf <- model_simp_nf(results[["H15_V0.1_L5.485_F1.99_S2"]])
View(data_nf)
data_f <- model_simp_f(results[["H15_V0.1_L5.485_F1.99_S2"]])
data_nf <- model_simp_nf(results[["H15_V0.1_L5.485_F1.99_S2"]])
plotting <- function(d_f, d_nf) {
df_nf <-
bind_rows(d_nf, d_nf %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
df_f <-
bind_rows(d_f, d_f %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og")) %>%
filter(focal == "TRUE", new == "og")
ggplot(data = df_nf, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_f, aes(t_h, light_ft), colour='red') +
geom_point(data = df_f, aes(t_h, light_ppa), colour='orange')
}
plotting(data_f, data_nf)
data_f <- model_simp_f(results[["H15_V0.25_L0.466_F1.99_S2"]])
data_nf <- model_simp_nf(results[["H15_V0.25_L0.466_F1.99_S2"]])
plotting(data_f, data_nf)
data_f <- model_simp_f(results[["H15_V0.25_L0.466_F1_S2"]])
data_nf <- model_simp_nf(results[["H15_V0.25_L0.466_F1_S2"]])
plotting(data_f, data_nf)
d_f = data_f
d_nf = data_nf
df_nf <-
bind_rows(d_nf, d_nf %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
View(df_nf)
df_f <-
bind_rows(d_f, d_f %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og")) %>%
filter(focal == "TRUE", new == "og")
View(df_f)
plotting <- function(d_nf, d_f) {
df_nf <-
bind_rows(d_nf, d_nf %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og"))
df_f <-
bind_rows(d_f, d_f %>% mutate(t_h = lead(t_h), new = "new")) %>%
arrange(desc(t_h)) %>%
replace_na(list(new = "og")) %>%
filter(focal == "TRUE", new == "og")
ggplot(data = df_nf, aes(t_h, light_ft)) +
geom_line(colour='green') +
geom_line(aes(t_h, light_ppa), colour='blue') +
geom_point(data = df_f, aes(t_h, light_ft), colour='red') +
geom_point(data = df_f, aes(t_h, light_ppa), colour='orange')
}
data_f <- model_simp_f(results[["H15_V0.1_L0.466_F1_S2"]])
data_nf <- model_simp_nf(results[["H15_V0.1_L0.466_F1_S2"]])
plotting(d_nf, d_f)
data_f <- model_simp_f(results[["H15_V0.1_L1.488_F1_S2"]])
data_nf <- model_simp_nf(results[["H15_V0.1_L1.488_F1_S2"]])
plotting(d_nf, d_f)
plotting(data_nf, data_f)
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
data_nf <- model_simp_nf(results[["H15_V0.5_L1.488_F1.99_S2"]])
plotting(data_nf, data_f)
View(data_f)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
View(data_f)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
View(data_f)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
View(data)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
View(data_f)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa))
}
model_simp_nf <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa)) %>%
filter(focal == "FALSE")
}
data_f <- model_simp_f(results[["H15_V0.5_L1.488_F1.99_S2"]])
View(data_f)
0.004657534 + 0.007123288 + 0.004109589 +0.004931507 + 0.0630137 + 30.73945 + 160.7816 + 412.2556 + 721.6304 + 993.4989 + 1166.151 + 1239.936 + 1199.67 + 1106.995 + 887.2534 + 675.4101 + 398.6479 + 177.2134 + 43.61918 + 1.04411 + 0.004657534 + 0.003287671 + 0.005753425 + 0.004109589
0.004657534 + 0.007123288 + 0.004109589 +0.004931507 + 0.0630137 + 30.73945 + 160.7816 + 412.2556 + 721.6304 + 993.4989 + 1166.151 + 1239.936 + 1199.67 + 1106.995 + 887.2534 + 675.4101 + 398.6479 + 177.2134 + 43.61918 + 1.04411 + 0.004657534 + 0.003287671 + 0.005753425 + 0.004109589
9214.948/24
383.9562*exp(-0.5*0)
383.9562*exp(-0.5*1)
data_f <- model_simp_f(results[["H15_V0.25_L5.485_F1.05_S3"]])
383.9562*exp(-0.5*2)
383.9562*exp(-0.5*2.296064289)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F1.99_S1"]])
383.9562*exp(-0.5*0)
161*exp(-0.5*0)
L = data_f %>%
filter(focal == "TRUE") %>%
I_z = I_0*exp(-k*L)
L = data_f %>%
filter(focal == "TRUE") %>%
I_z = I_0*exp(-k*L)
L = data_f %>%
filter(focal == "TRUE")
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
.$light_ft[1]
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai)
#light interception
#I_z = I_0\exp(-kL)
#I_z = light (PAR) at point z
I_0 = 383.9562
k = 0.5
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.character()
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai)
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.character()
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai)
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.character()
I_z = I_0*exp(-k*L)
-k*L
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L)
View(d_f)
#light interception
I_0 = 383.9562
k = 0.5
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai_paa) %>%
as.numeric()
data_f %>%
filter(focal == "TRUE")
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai_ppa) %>%
as.numeric()
I_z = I_0*exp(-k*L)
outputs <- data.frame(absPAR = I_z, H = 15, V = 0.5, L = 4.402, F = 1.99, S = 1)
View(outputs)
outputs %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
library(Maeswrap)
library(tidyverse)
outputs %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
library(data.table)
library(curl)
library(zip)
library(tidyverse)
library(CoordinateCleaner)
install.packages("CoordinateCleaner")
library(CoordinateCleaner)
