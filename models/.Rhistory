507 :516 , 538 :547 , 569 :578 , 600 :609)
LAI5.5_focal = c(433 :443 , 468 :478 , 503 :513 , 538:548, 573:583 , 608 :618 ,
643 :653 , 678 :688 , 713 :723 , 748:758 , 783:793)
deep_crown_distribution <-
d$httrunk[1:nrow(d)] %>%
purrr::map(deep_leaf_distribtuion_stand)
df <- tibble(
tree_num = rep(1:length(deep_crown_distribution), times = 50)) %>%
arrange(tree_num)
data <- plyr::ldply(deep_crown_distribution, data.frame) %>%
cbind(df) %>%
arrange(desc(h)) %>%
mutate(la = cumsum(larea)/6123)
if(nrow(data) == 100*50) {
data <- data %>%
filter(tree_num %in% LAI0.5_focal)
} else if(nrow(data) == 324*50) {
data <- data %>%
filter(tree_num %in% LAI1.5_focal)
} else if(nrow(data) == 676*50) {
data <- data %>%
filter(tree_num %in% LAI3_focal)
} else if(nrow(data) == 961*50) {
data <- data %>%
filter(tree_num %in% LAI4.5_focal)
} else if(nrow(data) == 1225*50) {
data <- data %>%
filter(tree_num %in% LAI5.5_focal)
}
}
PAR_calculator_DC_stand <- function(la) {
UMOLperStoMJperH <-
3600 /  # s / hr
4.57 /  # umol quanta / J
10^6    # J / MJ
met <- readmet(filename = "met.dat", nlines = -1) %>%
as_tibble() %>%
select(time = TIME, PAR) %>%
mutate(
PAR_one_s = 0.77 * PAR * exp(-0.77*la),
PAR_two_s = 0.77* PAR*(exp(-0.77*la) + (1- exp(-0.77*la))*exp(-0.35*la)),
MJ_per_H_one_s = PAR_one_s * UMOLperStoMJperH,
MJ_per_H_two_s = PAR_two_s * UMOLperStoMJperH )
tibble(absPAR_one_s = pracma::trapz(met$time, met$MJ_per_H_one_s) * 1,
absPAR_two_s = pracma::trapz(met$time, met$MJ_per_H_two_s) * 1)
}
applying_DC_stand <- function(data) {
data$la[1:nrow(data)] %>%
purrr::map(PAR_calculator_DC_stand) %>%
plyr::ldply(., data.frame)
}
summarise_DC_stand <- function(data) {
df <- tibble(tree = rep(1:(nrow(data)/50), times = 50)) %>%
arrange(tree)
d <- cbind(data, df) %>%
mutate(absPAR_one_s = absPAR_one_s*0.1,
absPAR_two_s = absPAR_two_s*0.1)
da <- d %>% group_by(tree) %>%
summarise(absPAR_one_s = mean(absPAR_one_s),
absPAR_two_s = mean(absPAR_two_s)) %>%
select(absPAR_one_s, absPAR_two_s) %>%
summarise(absPAR_one_s = sum(absPAR_one_s),
absPAR_two_s = sum(absPAR_two_s))
}
library(Maeswrap)
library(tidyverse)
library(ggplot2)
H <- c(15)
V <- c(0, 0.1, 0.25, 0.5)
L <- c(0.44, 1.521, 2.916, 4.556, 5.402)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
fla <- c(0.1)
S <- c(1, 2, 3)
combinations_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path))
results_fla_0.1 <- combinations_fla_0.1$path[1:nrow(combinations_fla_0.1)] %>%
purrr::map(load_trees)
names(results_fla_0.1) <- combinations_fla_0.1$path[1:nrow(combinations_fla_0.1)] %>%
basename()
model_conditions_fla_0.1 <- results_fla_0.1 %>%
purrr::map(model_simp)
results_PAR_ft_fla_0.1 <- model_conditions_fla_0.1 %>%
purrr::map(PAR_calculator_ft)
results_PAR_ppa_fla_0.1 <- model_conditions_fla_0.1 %>%
purrr::map(PAR_calculator_ppa)
final_results_ft_fla_0.1 <- organising_results(results_PAR_ft_fla_0.1, combinations_fla_0.1) %>%
add_column(model = "FLAT TOP")
final_results_ppa_fla_0.1 <- organising_results(results_PAR_ppa_fla_0.1, combinations_fla_0.1) %>%
add_column(model = "PPA")
final_results_ft_ppa_fla_0.1 <- rbind(final_results_ft_fla_0.1, final_results_ppa_fla_0.1) %>%
mutate(
absPAR_one_s =  absPAR_one_s*fla,
absPAR_two_s = absPAR_two_s*fla
)
deep_crown_fla_0.1 <- results_fla_0.1 %>%
purrr::map(deep_crown_set_up)
slices_DC_absPAR_fla_0.1 <- deep_crown_fla_0.1 %>%
purrr::map(applying_DC)
for(i in 1:nrow(combinations_fla_0.1)) {
slices_DC_absPAR_fla_0.1[[i]] <- slices_DC_absPAR_fla_0.1[[i]] %>%
mutate(
absPAR_one_s = absPAR_one_s*combinations_fla_0.1$fla[[i]],
absPAR_two_s = absPAR_two_s*combinations_fla_0.1$fla[[i]])
}
summarised_DC_results_fla_0.1 <-
slices_DC_absPAR_fla_0.1 %>%
purrr::map(summarise_DC)
final_results_DC_fla_0.1 <- organising_results(summarised_DC_results_fla_0.1, combinations_fla_0.1) %>%
add_column(model = "DEEP CROWN")
final_results_fla_0.1 <- rbind(final_results_DC_fla_0.1, final_results_ft_ppa_fla_0.1)
maespa_n_others_fla_0.1 <- rbind(final_results_fla_0.1, maespa_fla_0.1)
#fla 0.1
maespa_n_others_fla_0.1 %>%
mutate(absPAR_two_s = absPAR_two_s/0.1) %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
#geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "\nRatio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)\n",
colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 12),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 15),
axis.text = element_text(family = "Helvetica", size = 10),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 15),
legend.text = element_text(family = "Helvetica", colour = "black",
size = 12),
legend.title.align	= 0.5) +
scale_x_continuous(limits = c(0, 2)) +
scale_y_continuous(limits = c(0, 6))
maespa_n_others_fla_0.1$model <- factor(maespa_n_others_fla_0.1$model, levels = c("MAESPA", "PPA", "FLAT TOP", "DEEP CROWN"))
maespa_n_others_stand_fla_0.1$model <- factor(maespa_n_others_stand_fla_0.1$model, levels = c("MAESPA", "PPA", "FLAT TOP", "DEEP CROWN"))
maespa_n_others_c_fla$model <- factor(maespa_n_others_c_fla$model, levels = c("MAESPA", "PPA", "FLAT TOP", "DEEP CROWN"))
#fla 0.1
maespa_n_others_fla_0.1 %>%
mutate(absPAR_two_s = absPAR_two_s/0.1) %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
#geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "\nRatio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)\n",
colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 12),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 15),
axis.text = element_text(family = "Helvetica", size = 10),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 15),
legend.text = element_text(family = "Helvetica", colour = "black",
size = 12),
legend.title.align	= 0.5) +
scale_x_continuous(limits = c(0, 2)) +
scale_y_continuous(limits = c(0, 6))
H <- c(15)
V <- c(0.1)
L <- c(2.916)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
fla <- c(0.1, 0.5, 1, 10, 20, 40)
S <- c(1, 2, 3)
H <- c(15)
V <- c(0.1)
L <- c(2.916)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
fla <- c(0.1, 0.5, 1, 10, 20, 40)
S <- c(1, 2, 3)
combinations_c_fla <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_c_fla/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path))
combinations_c_fla
results_c_fla <- combinations_c_fla$path[1:nrow(combinations_c_fla)] %>%
purrr::map(load_trees)
names(results_c_fla) <- combinations_c_fla$path[1:nrow(combinations_c_fla)] %>%
basename()
model_conditions_c_fla <- results_c_fla %>%
purrr::map(model_simp)
results_PAR_ft_c_fla <- model_conditions_c_fla %>%
purrr::map(PAR_calculator_ft)
results_PAR_ppa_c_fla <- model_conditions_c_fla %>%
purrr::map(PAR_calculator_ppa)
final_results_ft_c_fla <- organising_results(results_PAR_ft_c_fla, combinations_c_fla) %>%
add_column(model = "FLAT TOP")
final_results_ppa_c_fla <- organising_results(results_PAR_ppa_c_fla, combinations_c_fla) %>%
add_column(model = "PPA")
final_results_ft_ppa_c_fla <- rbind(final_results_ft_c_fla, final_results_ppa_c_fla) %>%
mutate(
absPAR_one_s =  absPAR_one_s*fla,
absPAR_two_s = absPAR_two_s*fla
)
final_results_ft_ppa_c_fla
deep_crown_c_fla <- results_c_fla %>%
purrr::map(deep_crown_set_up)
slices_DC_absPAR_c_fla <- deep_crown_c_fla %>%
purrr::map(applying_DC)
for(i in 1:nrow(combinations_c_fla)) {
slices_DC_absPAR_c_fla[[i]] <- slices_DC_absPAR_c_fla[[i]] %>%
mutate(
absPAR_one_s = absPAR_one_s*combinations_c_fla$fla[[i]],
absPAR_two_s = absPAR_two_s*combinations_c_fla$fla[[i]])
}
summarised_DC_results_c_fla <-
slices_DC_absPAR_c_fla %>%
purrr::map(summarise_DC)
final_results_DC_c_fla <- organising_results(summarised_DC_results_c_fla, combinations_c_fla) %>%
add_column(model = "DEEP CROWN")
final_results_c_fla <- rbind(final_results_DC_c_fla, final_results_ft_ppa_c_fla)
maespa_n_others_c_fla <- rbind(final_results_c_fla, maespa_c_fla)
#changing focal tree la
names_c_fla <- as_labeller(
c(`0.1` = "0.1", `0.5` = "0.5", `1` = "1",
`10` = "10", `20` = "20", `40` = "40")
)
maespa_n_others_c_fla %>%
select(F, absPAR_two_s, model, fla, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_wrap(~fla, scales = "free", labeller = names_c_fla) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)", colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11),
legend.text = element_text(family = "Helvetica", colour = "black"),
legend.title.align	= 0.5)
maespa_n_others_c_fla$model <- factor(maespa_n_others_c_fla$model, levels = c("MAESPA", "PPA", "FLAT TOP", "DEEP CROWN"))
maespa_n_others_c_fla %>%
select(F, absPAR_two_s, model, fla, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_wrap(~fla, scales = "free", labeller = names_c_fla) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)", colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11),
legend.text = element_text(family = "Helvetica", colour = "black"),
legend.title.align	= 0.5)
H <- c(15)
V <- c(0, 0.1, 0.25, 0.5)
L <- c(0.44, 1.521, 2.916, 4.556, 5.402)
F <- c(1.00)
fla <- c(0.1)
S <- c(1, 2, 3)
combinations_stand_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_stand_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S)) %>%
add_column(name = basename(.$path))
results_stand_fla_0.1 <- combinations_stand_fla_0.1$path[1:nrow(combinations_stand_fla_0.1)] %>%
purrr::map(load_trees_stand)
names(results_stand_fla_0.1) <- combinations_stand_fla_0.1$path[1:nrow(combinations_stand_fla_0.1)] %>%
basename()
model_conditions_stand_fla_0.1 <- results_stand_fla_0.1 %>%
purrr::map(model_simp)
results_PAR_ft_stand_fla_0.1 <- model_conditions_stand_fla_0.1 %>%
purrr::map(PAR_calculator_ft_stand)
results_PAR_ppa_stand_fla_0.1 <- model_conditions_stand_fla_0.1 %>%
purrr::map(PAR_calculator_ppa_stand)
final_results_ft_stand_fla_0.1 <- organising_results_stand(results_PAR_ft_stand_fla_0.1, combinations_stand_fla_0.1) %>%
add_column(model = "FLAT TOP")
final_results_ppa_stand_fla_0.1 <- organising_results_stand(results_PAR_ppa_stand_fla_0.1, combinations_stand_fla_0.1) %>%
add_column(model = "PPA")
final_results_ft_ppa_stand_fla_0.1 <- rbind(final_results_ft_stand_fla_0.1, final_results_ppa_stand_fla_0.1)
deep_crown_stand_fla_0.1 <- results_stand_fla_0.1 %>%
purrr::map(deep_crown_set_up_stand)
slices_DC_absPAR_stand_fla_0.1 <- deep_crown_stand_fla_0.1 %>%
purrr::map(applying_DC_stand)
summarised_DC_results_stand_fla_0.1 <-
slices_DC_absPAR_stand_fla_0.1 %>%
purrr::map(summarise_DC_stand)
final_results_DC_stand_fla_0.1 <- organising_results_stand(summarised_DC_results_stand_fla_0.1, combinations_stand_fla_0.1) %>%
add_column(model = "DEEP CROWN")
final_results_stand_fla_0.1 <- rbind(final_results_DC_stand_fla_0.1, final_results_ft_ppa_stand_fla_0.1)
maespa_n_others_stand_fla_0.1 <- rbind(final_results_stand_fla_0.1, maespa_stand_fla_0.1)
#stand 0.1
names_stand <- as_labeller(
c(`0.1` = "0.1", `0.5` = "0.5", `1` = "1",
`10` = "10", `20` = "20", `40` = "40")
)
maespa_n_others_stand_fla_0.1 %>%
select(absPAR_two_s, model, V, L) %>%
ggplot(aes(L, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_wrap(~V) +
labs(x = "LAI", y = "Absorbed PAR (MJ m-2 d-1)",
colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11),
legend.text = element_text(family = "Helvetica", colour = "black"),
legend.title.align	= 0.5)
actual_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "MAESPA")
predicted_ppa_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "PPA")
predicted_ft_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "FLAT TOP")
predicted_DC_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "DEEP CROWN")
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)
library(Metrics)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)
actual_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "MAESPA")
predicted_ppa_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "PPA")
predicted_ft_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "FLAT TOP")
predicted_DC_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "DEEP CROWN")
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)^2
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)^2
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)^2
#fla 0.1
maespa_n_others_fla_0.1 %>%
mutate(absPAR_two_s = absPAR_two_s/0.1) %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
#geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "\nRatio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)\n",
colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 12),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 15),
axis.text = element_text(family = "Helvetica", size = 10),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 15),
legend.text = element_text(family = "Helvetica", colour = "black",
size = 12),
legend.title.align	= 0.5) +
scale_x_continuous(limits = c(0, 2)) +
scale_y_continuous(limits = c(0, 6))
actual_fla_0.1 <- maespa_n_others_fla_0.1 %>% filter(model == "MAESPA")
predicted_ppa_fla_0.1 <- maespa_n_others_fla_0.1 %>% filter(model == "PPA")
predicted_ft_fla_0.1 <- maespa_n_others_fla_0.1 %>% filter(model == "FLAT TOP")
predicted_DC_fla_0.1 <- maespa_n_others_fla_0.1 %>% filter(model == "DEEP CROWN")
rmse(actual_fla_0.1$absPAR_two_s, predicted_ppa_fla_0.1$absPAR_two_s)
rmse(actual_fla_0.1$absPAR_two_s, predicted_ft_fla_0.1$absPAR_two_s)
rmse(actual_fla_0.1$absPAR_two_s, predicted_DC_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)^2
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)^2
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)^2
actual_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "MAESPA")
predicted_ppa_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "PPA")
predicted_ft_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "FLAT TOP")
predicted_DC_stand_fla_0.1 <- maespa_n_others_stand_fla_0.1 %>% filter(model == "DEEP CROWN")
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)
rmse(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_ppa_stand_fla_0.1$absPAR_two_s)^2
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_ft_stand_fla_0.1$absPAR_two_s)^2
cor(actual_stand_fla_0.1$absPAR_two_s, predicted_DC_stand_fla_0.1$absPAR_two_s)^2
#changing focal tree la
names_c_fla <- as_labeller(
c(`0.1` = "0.1", `0.5` = "0.5", `1` = "1",
`10` = "10", `20` = "20", `40` = "40")
)
maespa_n_others_c_fla %>%
select(F, absPAR_two_s, model, fla, L) %>%
ggplot(aes(F, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_wrap(~fla, scales = "free", labeller = names_c_fla) +
labs(x = "Ratio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)", colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11),
legend.text = element_text(family = "Helvetica", colour = "black"),
legend.title.align	= 0.5)
#fla 0.1
maespa_n_others_fla_0.1 %>%
mutate(absPAR_two_s = absPAR_two_s/0.1) %>%
select(F, absPAR_two_s, absPAR_one_s, model, V, L) %>%
ggplot(aes(F, absPAR_two_s)) +
#geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "\nRatio focal tree height : stand", y = "Absorbed PAR (MJ m-2 d-1)\n",
colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 12),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 15),
axis.text = element_text(family = "Helvetica", size = 10),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 15),
legend.text = element_text(family = "Helvetica", colour = "black",
size = 12),
legend.title.align	= 0.5) +
scale_x_continuous(limits = c(0, 2)) +
scale_y_continuous(limits = c(0, 6))
maespa_n_others_stand_fla_0.1 %>%
select(absPAR_two_s, model, V, L) %>%
ggplot(aes(L, absPAR_two_s)) +
geom_point(aes(colour = as.factor(model))) +
geom_line(aes(colour = as.factor(model))) +
facet_wrap(~V) +
labs(x = "LAI", y = "Absorbed PAR (MJ m-2 d-1)",
colour = "Canopy Approximation") +
scale_colour_manual(labels = c("MAESPA", "PPA" , "Flat Top","Deep Crown"),
values = c("grey45","red", "#00BA38", "goldenrod2")) +
theme(
axis.ticks = element_line(colour = "grey"),
panel.grid.major = element_line(colour = "grey", size=0.1),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill="white"),
panel.border = element_rect(colour = "grey45", fill = NA),
legend.key = element_rect(fill = "white"),
strip.text = element_text(family = "Helvetica", colour = "black", size = 9),
axis.title = element_text(family = "Helvetica", colour = "black",
size = 11),
legend.title= element_text(family = "Helvetica", colour = "black",
size = 11),
legend.text = element_text(family = "Helvetica", colour = "black"),
legend.title.align	= 0.5)
