9214.948/24
383.9562*exp(-0.5*0)
383.9562*exp(-0.5*1)
data_f <- model_simp_f(results[["H15_V0.25_L5.485_F1.05_S3"]])
383.9562*exp(-0.5*2)
383.9562*exp(-0.5*2.296064289)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F1.99_S1"]])
383.9562*exp(-0.5*0)
161*exp(-0.5*0)
L = data_f %>%
filter(focal == "TRUE") %>%
I_z = I_0*exp(-k*L)
L = data_f %>%
filter(focal == "TRUE") %>%
I_z = I_0*exp(-k*L)
L = data_f %>%
filter(focal == "TRUE")
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
.$light_ft[1]
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai)
#light interception
#I_z = I_0\exp(-kL)
#I_z = light (PAR) at point z
I_0 = 383.9562
k = 0.5
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.character()
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai)
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.character()
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai)
View(L)
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.character()
I_z = I_0*exp(-k*L)
-k*L
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L)
View(d_f)
#light interception
I_0 = 383.9562
k = 0.5
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai_paa) %>%
as.numeric()
data_f %>%
filter(focal == "TRUE")
L = data_f %>%
filter(focal == "TRUE") %>%
select(lai_ppa) %>%
as.numeric()
I_z = I_0*exp(-k*L)
outputs <- data.frame(absPAR = I_z, H = 15, V = 0.5, L = 4.402, F = 1.99, S = 1)
View(outputs)
outputs %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
library(Maeswrap)
library(tidyverse)
outputs %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
library(data.table)
library(curl)
library(zip)
library(tidyverse)
library(CoordinateCleaner)
install.packages("CoordinateCleaner")
library(CoordinateCleaner)
library(Maeswrap)
library(tidyverse)
outputs <- tibble(
absPAR = data_f %>%
filter(focal == "TRUE") %>%
select(lai_ppa) %>%
as.numeric(),
H = 15, V = 0.5, L = 4.402, F = 1.99, S = 1)
View(outputs)
model_simp_f <- function(data) {
df <- data %>%
mutate(t_h = htcrown + httrunk) %>%
arrange(desc(t_h)) %>%
group_by(t_h, focal) %>%
summarise(larea = sum(larea)) %>%
ungroup() %>%
arrange(desc(t_h)) %>%
mutate(
lai = cumsum(larea)/10204,
light_ft = exp(-0.5*lai),
lai_ppa = floor(lai),
light_ppa = exp(-0.5*lai_ppa)) %>%
as_tibble()
}
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F1.99_S1"]])
results <- combinations$path[1:nrow(combinations)] %>%
purrr::map(load_trees)
View(results)
#light interception
I_0 = 383.9562
k = 0.5
results <- combinations$path[1:nrow(combinations)] %>%
purrr::map(load_trees)
View(results)
results[[1]]
#function to go through results and model_simp_F them all
simps <- results[[1]]:results[[1140]] %>%
purrr::map(model_simp_f)
%>%
simps <- results[[1]]:results[[1140]]
#function to go through results and model_simp_F them all
simps <- results[[1:1140]] %>%
purrr::map(model_simp_f)
names(results) <- combinations$path[1:nrow(combinations)] %>%
basename()
View(results)
View(combinations)
#function to go through results and model_simp_F them all
simps <- results[["H15_V0_L0.466_F1.99_S1"]] %>%
model_simp_f
View(simps)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F1.99_S1"]])
data_f1 <- model_simp_f(results[["H15_V0.5_L4.402_F0.01_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
L_ft = data_f1 %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z1 =I_0*exp(-k*L_ft)
outputs <- tibble(absPAR = c(I_z, I_z1), H = c(15, 15),
V = c(0.5, 0.5), L = c(4.402, 4.402), F = (1.99, 0.01))
outputs <- tibble(absPAR = c(I_z, I_z1), H = c(15, 15),
V = c(0.5, 0.5), L = c(4.402, 4.402), F = c(1.99, 0.01))
View(outputs)
data_f1 <- model_simp_f(results[["H15_V0.75_L5.485_F0.01_S1"]])
data_f1 <- model_simp_f(results[["H15_V0.75_L5.485_F0.01_S1"]])
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F1.99_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
outputs <- tibble(absPAR = I_z, H = 15, V = 0.5, L = 4.402, F = 0.01)
View(outputs)
View(outputs)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F0.01_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
outputs <- tibble(absPAR = I_z, H = 15, V = 0.5, L = 4.402, F = 0.01)
View(outputs)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F0.5_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
outputs <- tibble(absPAR = I_z, H = 15, V = 0.5, L = 4.402, F = 0.01)
results[["H15_V0.5_L4.402_F0.5_S1"]]
combinations_basenames <- combinations$path %>% basename()
combinations_basenames <- combinations %>% basename(combinations$path)
combinations_basenames <- combinations %>% basename(.,combinations$path)
combinations_basenames <- combinations$path %>% basename()
combinations <- add_column(name = combinations_basenames)
combinations <- combinations %>% add_column(name = combinations_basenames)
View(combinations)
combinations$name["H15_V0.5_L4.402_F0.5_S1"]
View(at)
View(combinations)
combinations$name
combinations %>%
filter(name == "H15_V0.5_L4.402_F0.5_S1")
df <- combinations %>%
filter(name == "H15_V0.5_L4.402_F0.5_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
d <- dataframe(I_z = c(0.004657534*exp(-k*L_ft), 0.007123288*exp(-k*L_ft)))
d <- data.frame(I_z = c(0.004657534*exp(-k*L_ft), 0.007123288*exp(-k*L_ft)))
View(d)
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
d <- data.frame(I_z = c(0.004657534*exp(-k*L_ft), 0.007123288*exp(-k*L_ft), 0.004109589*exp(-k*L_ft), 0.004931507*exp(-k*L_ft), 0.0630137*exp(-k*L_ft), 30.73945*exp(-k*L_ft),
160.7816*exp(-k*L_ft), 412.2556*exp(-k*L_ft), 721.6304*exp(-k*L_ft), 993.4989*exp(-k*L_ft),
1166.151*exp(-k*L_ft), 1239.936*exp(-k*L_ft), 1199.67*exp(-k*L_ft), 1106.995*exp(-k*L_ft), 887.2534*exp(-k*L_ft), 675.4101*exp(-k*L_ft), 398.6479*exp(-k*L_ft), 177.2134*exp(-k*L_ft),
43.61918*exp(-k*L_ft), 1.04411*exp(-k*L_ft),
0.004657534*exp(-k*L_ft), 0.003287671*exp(-k*L_ft), 0.005753425*exp(-k*L_ft), 0.004109589*exp(-k*L_ft)))
View(d)
mean(d$I_z)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F0.5_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
d <- data.frame(I_z = c(0.004657534*exp(-k*L_ft), 0.007123288*exp(-k*L_ft), 0.004109589*exp(-k*L_ft), 0.004931507*exp(-k*L_ft), 0.0630137*exp(-k*L_ft), 30.73945*exp(-k*L_ft),
160.7816*exp(-k*L_ft), 412.2556*exp(-k*L_ft), 721.6304*exp(-k*L_ft), 993.4989*exp(-k*L_ft),
1166.151*exp(-k*L_ft), 1239.936*exp(-k*L_ft), 1199.67*exp(-k*L_ft), 1106.995*exp(-k*L_ft), 887.2534*exp(-k*L_ft), 675.4101*exp(-k*L_ft), 398.6479*exp(-k*L_ft), 177.2134*exp(-k*L_ft),
43.61918*exp(-k*L_ft), 1.04411*exp(-k*L_ft),
0.004657534*exp(-k*L_ft), 0.003287671*exp(-k*L_ft), 0.005753425*exp(-k*L_ft), 0.004109589*exp(-k*L_ft)))
I_z = I_0*exp(-k*L_ft)
mean(d$I_z)
sum(d$I_z)
1239.936*exp(-k*L_ft)
d$I_z[12]
I_z = I_0*exp(-k*L_ft)
I_z = 383.9562*exp(-k*L_ft)
simulation <- results[["H15_V0_L4.402_F1_S1"]]
data_f <- model_simp_f(results[[simulation]])
simulation <- "H15_V0_L4.402_F1_S1"
data_f <- model_simp_f(results[["simulation"]])
data_f <- model_simp_f(results[["H15_V0_L4.402_F1_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F1_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
data_f <- model_simp_f(results[["H15_V0_L0.466_F1_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0_L0.466_F1_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
View(combinations)
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
S <- c(1, 2, 3)
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
View(combinations)
d <- c(1, 2, 3)
i <- c(1,2,4)
expand_grid(d, i)
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
data_f <- model_simp_f(results[["H15_V0_L0.466_F0.5_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0_L0.466_F1_S1")
df <- combinations %>%
filter(name == "H15_V0_L0.466_F0.5_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
data_f <- model_simp_f(results[["H15_V0_L4.402_F0.5_S1"]])
#function for absPAR to all
I_0 = 383.9562
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F0.5_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F0.5_S1")
data_f <- model_simp_f(results[["H15_V0_L4.402_F0.5_S1"]])
combinations
combinations_basenames <- combinations$path %>% basename()
combinations <- combinations %>% add_column(name = combinations_basenames)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F0.5_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
combinations_basenames <- combinations$path %>% basename()
library(Maeswrap)
library(tidyverse)
data_f <- model_simp_f(results[["H15_V0_L4.402_F0.5_S1"]])
#function for absPAR to all
I_0 = 383.9562 #average PAR for the whole day
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F0.5_S1")
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
combinations_basenames <- combinations$path %>%
basename()
combinations <- combinations %>%
add_column(name = combinations_basenames)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F0.5_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
data_f <- model_simp_f(results[["H15_V0_L4.402_F0.01_S1"]])
#function for absPAR to all
I_0 = 383.9562 #average PAR for the whole day
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0_L4.402_F0.01_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F0.01_S1"]])
#function for absPAR to all
I_0 = 383.9562 #average PAR for the whole day
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L4.402_F0.01_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F1.99_S1"]])
#function for absPAR to all
I_0 = 383.9562 #average PAR for the whole day
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L4.402_F1.99_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
View(outputs)
outputs
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F0.5_S1"]])
#function for absPAR to all
I_0 = 383.9562 #average PAR for the whole day
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L4.402_F0.5_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
outputs
data_f <- model_simp_f(results[["H15_V0.5_L4.402_F0.01_S1"]])
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L4.402_F0.01_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
outputs
data_f <- model_simp_f(results[["H15_V0.5_L5.485_F0.01_S1"]])
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L4.402_F0.01_S1")
data_f <- model_simp_f(results[["H15_V0.5_L5.485_F0.01_S1"]])
L_ft = data_f %>%
filter(focal == "TRUE") %>%
select(lai) %>%
as.numeric()
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L5.485_F0.01_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
outputs
View(L0.5)
L_ft = data_f %>%
filter(focal == "TRUE") %>%
pull(lai)
I_z = I_0*exp(-k*L_ft)
I_z
data_f
data_f <- model_simp_f(results[["H15_V0.5_L5.485_F0.01_S1"]])
#function for absPAR to all
I_0 = 383.9562 #average PAR for the whole day
k = 0.5
L_ft = data_f %>%
filter(focal == "TRUE") %>%
pull(lai)
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L5.485_F0.01_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
outputs
data_f <- model_simp_f(results[["H15_V0.5_L5.485_F1.99_S1"]])
L_ft = data_f %>%
filter(focal == "TRUE") %>%
pull(lai)
I_z = I_0*exp(-k*L_ft)
df <- combinations %>%
filter(name == "H15_V0.5_L5.485_F1.99_S1")
outputs <- tibble(absPAR = I_z, H = df$H, V = df$V, L = df$L, F = df$L, S = df$S)
outputs
#function for absPAR to all
PAR <- c(0.004657534, 0.007123288, 0.004109589, 0.004931507, 0.0630137, 30.73945, 160.7816, 412.2556, 721.6304,
993.4989, 1166.151, 1239.936, 1199.67, 1106.995, 887.2534, 675.4101, 398.6479, 177.2134, 43.61918,
1.04411, 0.004657534, 0.003287671, 0.005753425, 0.004109589)
library(Maeswrap)
library(tidyverse)
absPAR_hour <- data_frame(hour = c(1:24), PAR = PAR)
absPAR_hour <- tibble(hour = c(1:24), PAR = PAR)
View(absPAR_hour)
absPAR_hour <- tibble(hour = c(1:24), PAR = PAR, absPAR = 383.9562*exp(-0.5*PAR[1:24]))
View(absPAR_hour)
data_f <- model_simp_f(results[["H15_V0.5_L5.485_F1.99_S1"]])
L_ft = data_f %>%
filter(focal == "TRUE") %>%
pull(lai)
#function for absPAR to all
PAR <- c(0.004657534, 0.007123288, 0.004109589, 0.004931507, 0.0630137, 30.73945, 160.7816, 412.2556, 721.6304,
993.4989, 1166.151, 1239.936, 1199.67, 1106.995, 887.2534, 675.4101, 398.6479, 177.2134, 43.61918,
1.04411, 0.004657534, 0.003287671, 0.005753425, 0.004109589)
absPAR_hour <- tibble(hour = c(1:24), PAR = PAR, absPAR = PAR[1:24]*exp(-0.5*L_ft))
0.004657534*exp(-0.5*L_ft)
library(Maeswrap)
library(tidyverse)
#function for absPAR to all
PAR <- c(0.004657534, 0.007123288, 0.004109589, 0.004931507, 0.0630137, 30.73945, 160.7816, 412.2556, 721.6304,
993.4989, 1166.151, 1239.936, 1199.67, 1106.995, 887.2534, 675.4101, 398.6479, 177.2134, 43.61918,
1.04411, 0.004657534, 0.003287671, 0.005753425, 0.004109589)
L_ft = data_f %>%
filter(focal == "TRUE") %>%
pull(lai)
absPAR_hour <- tibble(hour = c(1:24), PAR = PAR, absPAR = PAR[1:24]*exp(-0.5*L_ft))
View(absPAR_hour)
L_ft
f <- x*exp(-0.5*0.1400039)
x
integrate(f, lower = 0.003287671, upper = 1239.936)
f <- function(x) {x*exp(-0.5*0.1400039)}
integrate(f, lower = 0.003287671, upper = 1239.936)
absPAR_hour <- tibble(hour = c(1:24), PAR = PAR, absPAR = PAR[1:24]*exp(-0.5*L_ft),
absPAR_short = floor(absPAR))
