S <- c(1, 2, 3)
combinations_A <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations_A/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
library(Maeswrap)
library(rgl)
library(tidyverse)
#for the average one with everything
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
WD <- c(0, 1)
S <- c(1, 2, 3)
View(combinations)
combinations_A <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations_A/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
View(combinations_A)
for(i in 1:nrow(combinations_A)) {
create_simulation(path = combinations_A$path[i], template = "template_A", h_mn = combinations_A$H[i], h_cv = combinations_A$V[i],
LAI = combinations_A$L[i], ft_h = combinations_A$F[i], seed = combinations_A$S[i])
}
for(i in 1:nrow(combinations_A)) {
run_simulation(path = combinations_A$path[i])
}
output_A <- combinations_A$path %>%
purrr:: map_df(load_output)
output_combined_A <- combinations_A %>%
left_join(output_A, by = "path")
mn_outputs_A <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
A <- aggregate(output_combined_A$totPs, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
A <- rename(A, totPs = x)
B <- aggregate(output_combined_A$absPAR, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
B <- rename(B, absPAR = x)
C <- aggregate(output_combined_A$absNIR, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
C <- rename(C, absNIR = x)
D <- aggregate(output_combined_A$absTherm, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
D <- rename(D, absTherm = x)
E <- aggregate(output_combined_A$netPs, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
E <- rename(E, netPs = x)
F <- aggregate(output_combined_A$totRf, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
F <- rename(F, totRF = x)
G <- aggregate(output_combined_A$totLE1, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
G <- rename(G, totLE1 = x)
H <- aggregate(output_combined_A$totLE2, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
H <- rename(H, totLE2 = x)
I <- aggregate(output_combined_A$totH, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
I <- rename(I, totH = x)
absPAR <- B$absPAR
absNIR <- C$absNIR
absTherm <- D$absTherm
netPs <- E$netPs
totRF <- F$totRF
totLE1 <- G$totLE1
totLE2 <- H$totLE2
totH <- I$totH
path <- output_combined_A$path
mn_outputs_A <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
names <- as_labeller(
c(`0` = "V 0", `0.1` = "V 0.1", `0.25` = "V 0.25", `0.5` = "V 0.5", `0.75` = "V 0.75",
`0.466` = "LAI 0.494", `1.488`= "LAI 1.429", `2.916`= "LAI 2.616", `4.402`= "LAI 4.159", `5.485`= "LAI 5.07")
)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
library(Maeswrap)
library(rgl)
library(tidyverse)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
names <- as_labeller(
c(`0` = "V 0", `0.1` = "V 0.1", `0.25` = "V 0.25", `0.5` = "V 0.5", `0.75` = "V 0.75",
`0.466` = "LAI 0.467", `1.488`= "LAI 1.349", `2.916`= "LAI 2.917", `4.402`= "LAI 4.485", `5.485`= "LAI 5.395")
)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
mn_outputs_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
library(Maeswrap)
library(rgl)
library(tidyverse)
library(Maeswrap)
library(rgl)
library(tidyverse)
names <- as_labeller(
c(`0` = "V 0", `0.1` = "V 0.1", `0.25` = "V 0.25", `0.5` = "V 0.5", `0.75` = "V 0.75",
`0.466` = "LAI 0.467", `1.488`= "LAI 1.349", `2.916`= "LAI 2.917", `4.402`= "LAI 4.485", `5.485`= "LAI 5.395")
)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
View(mn_outputs_A)
library(Maeswrap)
library(rgl)
library(tidyverse)
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
#for the average one with everything
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
WD <- c(0, 1)
S <- c(1, 2, 3)
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
create_simulation(path = combinations$path[1], template = "template", h_mn = combinations$H[1], h_cv = combinations$V[1],
LAI = combinations$L[1], ft_h = combinations$F[1], seed = combinations$S[1])
run_simulation(path = combinations$path[1])
View(mn_outputs_A)
library(Maeswrap)
library(rgl)
library(tidyverse)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
mn_outputs_A
View(mn_outputs_A)
output_A <- combinations_A$path %>%
purrr:: map_df(load_output)
output_combined_A <- combinations_A %>%
left_join(output_A, by = "path")
A <- aggregate(output_combined_A$totPs, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
A <- rename(A, totPs = x)
B <- aggregate(output_combined_A$absPAR, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
B <- rename(B, absPAR = x)
C <- aggregate(output_combined_A$absNIR, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
C <- rename(C, absNIR = x)
D <- aggregate(output_combined_A$absTherm, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
D <- rename(D, absTherm = x)
E <- aggregate(output_combined_A$netPs, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
E <- rename(E, netPs = x)
F <- aggregate(output_combined_A$totRf, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
F <- rename(F, totRF = x)
G <- aggregate(output_combined_A$totLE1, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
G <- rename(G, totLE1 = x)
H <- aggregate(output_combined_A$totLE2, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
H <- rename(H, totLE2 = x)
I <- aggregate(output_combined_A$totH, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
I <- rename(I, totH = x)
absPAR <- B$absPAR
absNIR <- C$absNIR
absTherm <- D$absTherm
netPs <- E$netPs
totRF <- F$totRF
totLE1 <- G$totLE1
totLE2 <- H$totLE2
totH <- I$totH
path <- output_combined_A$path
mn_outputs_A <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
output_combined_A
output_combined_A %>%
group_by(H, V, L, F, Tree) %>%
summarise(absPAR = mean(absPAR))
output_combined_A %>%
group_by(H, V, L, F, Tree) %>%
summarise_at(vars(absPAR, absNIR), mean)
mn_outputs_A <- output_combined_A %>%
group_by(H, V, L, F, Tree) %>%
summarise_at(vars(absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH), mean)
output_combined_A
mn_outputs_A <- output_combined_A %>%
group_by(H, V, L, F, Tree) %>%
summarise_at(vars(absPAR, absNIR, absTherm, totPs, netPs, totRf, totLE1, totLE2, totH), mean)
mn_outputs_A
output_combined_A$path
output_combined_A$path %>% basename()
output_combined_A$path %>% basename() %>% gsub("_S1", "",.)
output_combined_A$path %>% basename() %>% gsub("_S[1-3]", "",., perl = TRUE)
load_output <- function(path){
readdayflux(filename = file.path(path,"dayflx.dat")) %>%
as_tibble() %>%
mutate(path = path, name = path %>% basename() %>% gsub("_S[1-3]", "",., perl = TRUE))
}
output_A <- combinations_A$path %>%
purrr:: map_df(load_output)
output_combined_A <- combinations_A %>%
left_join(output_A, by = "path")
mn_outputs_A <- output_combined_A %>%
group_by(H, V, L, F, Tree, name) %>%
summarise_at(vars(absPAR, absNIR, absTherm, totPs, netPs, totRf, totLE1, totLE2, totH), mean)
View(mn_outputs_A)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "MAESPA")
output_combined_WD
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
library(Maeswrap)
library(rgl)
library(tidyverse)
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
output_combined_WD <- combinations_WD %>%
left_join(output_WD, by = "path")
output_combined_WD
View(output_combined_WD)
mn_outputs_WD <- output_combined_WD %>%
group_by(H, V, L, F, WD, Tree, name) %>%
summarise_at(vars(absPAR, absNIR, absTherm, totPs, netPs, totRf, totLE1, totLE2, totH), mean)
mn_outputs_WD
output_combined_WD
mn_outputs_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
View(combinations)
View(combinations)
library(Maeswrap)
library(rgl)
library(tidyverse)
create_simulation(path = "simulations/t", template = "template", h_mn = 15, h_cv = 0.25,
LAI = 2.916, ft_h = 1, seed = 3)
run_simulation(path = "simulations/t")
create_simulation(path = "simulations/t", template = "template", h_mn = 15, h_cv = 0.25,
LAI = 2.916, ft_h = 1, seed = 3)
run_simulation(path = "simulations/t")
run_simulation(path = "simulations/t")
run_simulation(path = "simulations/t")
run_simulation(path = "simulations/t")
run_simulation(path = "simulations/t")
run_simulation(path = "simulations/t")
library(Maeswrap)
library(rgl)
library(tidyverse)
View(mn_outputs_A)
View(one)
View(output_combined_A)
View(one)
create_simulation(path = "simualtions/T", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/T")
run_simulation(path = "simualtions/T")
create_simulation(path = "simualtions/T", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/T")
create_simulation(path = "simualtions/T", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/T")
create_simulation(path = "simualtions/T", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/T")
create_simulation(path = "simualtions/Q", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/Q")
run_simulation(path = "simualtions/Q")
create_simulation(path = "simualtions/Q", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/Q")
create_simulation(path = "simualtions/Q", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/Q")
create_simulation(path = "simualtions/Q", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/Q")
create_simulation(path = "simualtions/Q", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/Q")
create_simulation(path = "simualtions/Q", template = "template", h_mn = 15, h_cv = 0.5,
LAI = 5.485, ft_h = 1.99, seed = 1)
run_simulation(path = "simualtions/Q")
View(output_combined_A)
View(mn_outputs_A)
output_combined_A
View(output_combined_A)
output_combined_A
output_combined_A
View(output_combined_A)
View(output_combined_A)
View(mn_outputs_A)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "MAESPA")
library(Maeswrap)
library(rgl)
library(tidyverse)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "MAESPA")
View(mn_outputs)
sapply(mn_outputs_A, mode)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "MAESPA") +
scale_color_manual(values = c("#00AFBB"))
write.csv(mn_outputs_A)
write.csv(mn_outputs_A, "simulations")
mn_outputs_WD
A <- mn_outputs_WD %>% as.data.frame()
library(Maeswrap)
library(rgl)
library(tidyverse)
write.csv(A, "simulations")
write.csv(A)
write.csv(Am 'A')
write.csv(A, 'A.csv')
mn_outputs_A
A <- as.data.frame(mn_outputs_A)
write.csv(A, 'A')
A
write.csv(A, 'A.csv')
View(mn_outputs_A)
library(Maeswrap)
library(rgl)
library(tidyverse)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "MAESPA") +
scale_color_manual(values = c("#00AFBB"))
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "FT height", y = "Absorbed PAR", colour = "MAESPA") +
scale_color_manual(values = c("#00AFBB"))
output_fla_0.1 <- combinations_fla_0.1$path %>%
purrr:: map_df(load_output)
library(Maeswrap)
library(rgl)
library(tidyverse)
output_c_fla <- combinations_c_fla$path %>%
purrr:: map_df(load_output)
output_fla_0.1 <- combinations_fla_0.1$path %>%
purrr:: map_df(load_output)
output_fla_0.1 <- combinations_fla_0.1$path %>%
purrr:: map_df(load_output)
combinations_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S))
#redoing maespa but with 0.1 la for focal tree
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
fla <- c(0.1)
S <- c(1, 2, 3)
combinations_fla_0.1 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_fla_0.1/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S))
output_fla_0.1 <- combinations_fla_0.1$path %>%
purrr:: map_df(load_output)
output_combined_fla_0.1 <- combinations_fla_0.1 %>%
left_join(output_fla_0.1, by = "path")
mn_outputs_fla_0.1 <- output_combined_fla_0.1 %>%
group_by(H, V, L, F, fla, Tree, name) %>%
summarise_at(vars(absPAR, absNIR, absTherm, totPs, netPs, totRf, totLE1, totLE2, totH), mean)
mn_outputs_fla_0.1 %>%
select(F, absPAR, fla) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(fla))) +
geom_line(aes(colour = as.factor(fla))) +
labs(x = "FT height", y = "Absorbed PAR", colour = "MAESPA")
mn_outputs_fla_0.1 %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(fla))) +
geom_line(aes(colour = as.factor(fla))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(x = "FT height", y = "Absorbed PAR", colour = "MAESPA")
mn_outputs_fla_0.1
write_csv(mn_outputs_fla_0.1, "maespa_fla_0.1.csv")
#for the average one with everything and 47.62 la
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
fla <- c(47.62)
S <- c(1, 2, 3)
library(Maeswrap)
library(rgl)
library(tidyverse)
combinations_fla_47.62 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_A/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S))
View(combinations_fla_47.62)
create_trees <- function(path, h_mn = 10, h_cv = 0.1, LAI = 1.54, ft_h = 1.99, fla = 1,
plot_area = 20000, indivlarea = 47.62, indivrad = 5.087809/2,
indivhtcrown = 6.359762, indivdiam = 0.3, seed = 6, half = 1/2) {
wd <- setwd(path)
on.exit(setwd(wd))
set.seed(seed)
h_sd <- h_mn * h_cv
ntrees <- ceiling(plot_area*(LAI/indivlarea))
sqrt_n <- ceiling(sqrt(ntrees))
SD_height_df <- SD_height(n = ntrees, h_mn, h_sd, sn = sqrt_n)
coordinates <- create_coordinates(sqrt_n)
ft <- floor((sqrt_n*floor(sqrt_n*half)) + ceiling(half*sqrt_n))
SD_height_df <- replace(SD_height_df$., ft, h_mn*ft_h)
perimeter_h <- replace_perimeter_h(ntrees, sqrt_n, indivhtcrown, h_mn)
perimeter_r <- replace_perimeter_r(ntrees, sqrt_n, indivrad)
perimeter_la <- replace_perimeter_la(ntrees, sqrt_n, indivlarea) %>%
replace(., ft, fla)
replacePAR("confile.dat", "itargets", "treescon", newval = ft)
replacePAR("confile.dat", "notrees", "treescon", newval = ntrees)
replacePAR("Trees.dat", "xycoords", "xy", newval= coordinates)
replacePAR("Trees.dat", "values", "indivhttrunk", newval = SD_height_df)
replacePAR("Trees.dat", "notrees", "plot", newval = ntrees)
replacePAR("Trees.dat", "values", "indivradx", newval = perimeter_r)
replacePAR("Trees.dat", "values", "indivrady", newval = perimeter_r)
replacePAR("Trees.dat", "values", "indivhtcrown", newval = perimeter_h)
replacePAR("Trees.dat", "values", "indivdiam", newval = rep(indivdiam, ntrees))
replacePAR("Trees.dat", "values", "indivlarea", newval = perimeter_la)
}
for(i in 1:nrow(combinations_fla_47.62)) {
create_simulation(path = combinations_fla_47.62$path[i], template = "template_A",
h_mn = combinations_fla_47.62$H[i], h_cv = combinations_fla_47.62$V[i],
LAI = combinations_fla_47.62$L[i], ft_h = combinations_fla_47.62$F[i],
fla = combinations_fla_47.62$fla[i], seed = combinations_fla_47.62$S[i])
}
combinations_fla_47.62 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_fla_47.62/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S))
combinations_fla_47.62
combinations_fla_47.62 <- expand_grid(H, V, L, F, fla, S) %>%
mutate(path = sprintf("simulations_fla_47.62/H%s_V%s_L%s_F%s_fla%s_S%s", H, V, L, F, fla, S))
for(i in 1:nrow(combinations_fla_47.62)) {
create_simulation(path = combinations_fla_47.62$path[i], template = "template_A",
h_mn = combinations_fla_47.62$H[i], h_cv = combinations_fla_47.62$V[i],
LAI = combinations_fla_47.62$L[i], ft_h = combinations_fla_47.62$F[i],
fla = combinations_fla_47.62$fla[i], seed = combinations_fla_47.62$S[i])
}
for(i in 1:nrow(combinations_fla_47.62)) {
run_simulation(path = combinations_fla_47.62$path[i])
}
output_fla_47.62 <- combinations_fla_47.62$path %>%
purrr:: map_df(load_output)
output_combined_fla_47.62 <- combinations_fla_47.62 %>%
left_join(output_fla_47.62, by = "path")
mn_outputs_fla_47.62 <- output_combined_fla_47.62 %>%
group_by(H, V, L, F, fla, Tree, name) %>%
summarise_at(vars(absPAR, absNIR, absTherm, totPs, netPs, totRf, totLE1, totLE2, totH), mean)
mn_outputs_fla_47.62
write.csv(mn_outputs_fla_47.62, "maespa_fla_47.62.csv")
View(create_trees)
